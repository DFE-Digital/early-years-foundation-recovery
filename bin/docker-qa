#!/bin/sh
#
# @see https://github.com/SeleniumHQ/docker-selenium
#
# Generate self-signed certificates before running using:
#   $ ./bin/docker-certs
#
# @example
#
#   $ TYPE=firefox BASE_URL=https://app:3000 ./bin/docker-qa
#   $ BASE_URL=https://ey-recovery.london.cloudapps.digital USER_PASSWORD=secret ./bin/docker-qa
#
# ------------------------------------------------------------------------------
set -e

TYPE=${TYPE-"chrome"}

BASE_URL=${BASE_URL-"https://app:3000"} \
BROWSER=${BROWSER-"standalone_$TYPE"} \
DRIVER=${DRIVER-"$TYPE:4444"} \
  docker-compose \
    -f docker-compose.yml \
    -f docker-compose.qa.yml \
    --project-name recovery \
    run \
    --volume="$PWD/ui:/srv/spec" \
    --name recovery_qa \
    --rm qa \
    rspec "$@"
